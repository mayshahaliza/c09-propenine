<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <title>register</title>
</head>

<body>
<nav th:replace="~{fragments/admin_navbar :: admin_navbar}"></nav>
    <div class="container">

    <div class="text-center" th:if="${user.role == 'admin'}"> </div>

        <h1>User Registration Form</h1>
            <form th:action="@{/registerUser}" th:object="${userRegister}" method="POST">
                <div class="mb-3">
                    <label for="formNamaDepan" class="form-label">Nama Depan</label>
                    <input type="text" th:field = "*{nama_depan}" class="form-control" id="formNamaDepan" placeholder ="Masukkan nama depan">

                </div>

                <div class="mb-3">
                    <label for="formNamaBelakang" class="form-label">Nama Belakang</label>
                    <input type="text" th:field = "*{nama_belakang}" class="form-control" id="formNamaBelakang" placeholder ="Masukkan nama belakang">
                </div>

                <div class="mb-3">
                    <label for="formEmail" class="form-label">Email</label>
                    <input type="text" th:field = "*{email}"  class="form-control" id="formEmail" placeholder ="Masukkan email">
                </div>

                <div class="mb-3">
                    <label for="formNomorHp" class="form-label">Nomor Hp</label>
                    <input type="number" th:field = "*{nomor_hp}"  class="form-control" id="formNomorHp" placeholder ="Masukkan nomor hp">
                </div>

                <div class="mb-3">
                    <label for="formAlamat" class="form-label">Alamat</label>
                    <input type="text" th:field = "*{alamat}" class="form-control" id="formAlamat" placeholder ="Masukkan alamat">
                </div>

                <div class="mb-3">
                    <label for="formTanggalLahir" class="form-label">Tanggal Lahir</label>
                    <input type="date" th:field = "*{tanggal_lahir}" class="form-control" id="formTanggalLahir">
                </div>

                <div class="mb-3">
                    <label for="formTempatLahir" class="form-label">Tempat Lahir</label>
                    <input type="text" th:field = "*{tempat_lahir}" class="form-control" id="formTempatLahir" placeholder ="Masukkan tempat lahir">
                </div>

                <div class="mb-3">
                    <label for="formRole" th:field = "*{role}"  class="form-label">Role</label>
                    <select class="form-select" id="formRole" name="role">
                        <option value="admin">Admin</option>
                        <option value="operational">Operational</option>
                        <option value="hr">HR</option>
                        <option value="executive">Executive</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="formStatusKaryawan" class="form-label">Status Karyawan</label>
                    <select class="form-select" id="formStatusKaryawan" th:field = "*{status_karyawan}" name="statusKaryawan">
                        <option value="0">Tidak Aktif</option>
                        <option value="1">Aktif</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="formUsername" class="form-label">Username</label>
                    <input type="text" th:field = "*{username}" class="form-control" id="formUsername" placeholder ="Masukkan username">
                </div>

                <div class="mb-3">
                    <label for="formPassword" class="form-label">Password</label>
                    <input type="password" th:field = "*{password}" class="form-control" id="formPassword" placeholder ="Masukkan password">
                </div>

                <div class="alert alert-danger" th:if="${errors != null and not #lists.isEmpty(errors)}">
                    <p th:text="${errors[0].defaultMessage}"></p>
                </div>

                <div class="alert alert-danger" th:if="${duplicateError}" th:text="${duplicateError}"></div>

                <button type="submit" class="btn btn-success">Register</button>
            </form>

        <!-- Error Modal -->
            <div class="modal" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="errorModalLabel">Registration Failed</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p th:if="${errors != null and not #lists.isEmpty(errors)}" th:text="${errors[0].defaultMessage}"></p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-bs-dismiss="modal">OK</button>
                        </div>
                    </div>
                </div>
            </div>

        <div th:unless="${user.role == 'admin'}">
            <script th:inline="javascript">
            /*<![CDATA[*/
            window.location.replace('/no-access');
            /*]]>*/
        </script>
        </div>

        <script th:inline="javascript">
            /*<![CDATA[*/
            $(document).ready(function () {
                /* Display modal if there is an error message */
                var errorMessage = /*[[${errors != null and not #lists.isEmpty(errors)} ? errors[0].defaultMessage : '']]*/ '';
                if (errorMessage) {
                    $('#errorModal').modal('show');
                }
            });
            /*]]>*/
        </script>

    </div>

</body>

</html>